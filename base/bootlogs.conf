description "Save kernel messages in /var/log/dmesg"

start on filesystem and started hostname.sh

pre-start script
	[ -f /var/log/dmesg ] && savelog -q -p -c 5 /var/log/dmesg

	if which dmesg >/dev/null 2>&1
	then
		dmesg -s 524288 > /var/log/dmesg
	elif [ -c /dev/klog ]
	then
		dd if=/dev/klog of=/var/log/dmesg count=1024
	fi

	if [ -f /var/log/dmesg ]
	then
		chgrp adm /var/log/dmesg || :
	fi
end script
